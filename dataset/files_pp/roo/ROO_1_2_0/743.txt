springframework roo felix pgp file fileinputstream file input stream fileoutputstream file output stream ioexception exception inputstream input stream outputstream output stream net malformedurlexception malformed url exception net url security security util arraylist array list util collections util comparator util iterator util list util sortedmap sorted map util sortedset sorted set util treemap tree map util treeset tree set felix scr annotations component felix scr annotations reference felix scr annotations service bouncycastle bcpg armoredinputstream armored input stream bouncycastle jce provider bouncycastleprovider bouncy castle provider bouncycastle openpgp pgpcompresseddata pgp compressed data bouncycastle openpgp pgpobjectfactory pgp object factory bouncycastle openpgp pgppublickey pgp key bouncycastle openpgp pgppublickeyring pgp key ring bouncycastle openpgp pgppublickeyringcollection pgp key ring collection bouncycastle openpgp pgpsignature pgp signature bouncycastle openpgp pgpsignaturelist pgp signature list bouncycastle openpgp pgputil pgp util osgi framework bundlecontext bundle context osgi service component componentcontext component context springframework roo support osgi osgiutils utils springframework roo support util springframework roo support util ioutils utils springframework roo support util stringutils utils springframework roo url stream urlinputstreamservice url input stream service implementation link pgpservice pgp service stores user user pgp code spring roo pgp bpg code file key file considered trusted user expiration times ship roo file automatically file disk implementation verify detached armored signatures produce file gpg armor detach sign file sign ext author ben alex component service pgpserviceimpl pgp service impl pgpservice pgp service constants buffer size file roo pgp file file system getproperty property user file separatorchar separator spring roo pgp bpg fields defaultkeyserverurl key server url http keyserver ubuntu pks lookup search defaultkeyserverurl key server url http pgp mit pks lookup search security addprovider add provider bouncycastleprovider bouncy castle provider instance fields reference urlinputstreamservice url input stream service urlinputstreamservice url input stream service automatictrust automatic trust bundlecontext bundle context context sortedset sorted set pgpkeyid pgp key discoveredkeyids discovered key ids treeset tree set pgpkeyid pgp key activate componentcontext component context context context context getbundlecontext bundle context keyserver context getbundlecontext bundle context getproperty property pgp keyserver url stringutils utils hastext text keyserver defaultkeyserverurl key server url keyserver trustdefaultkeysifrequired trust required seed discovered database gettrustedkeys trusted trustdefaultkeysifrequired trust required setup trust automatically trustdefaultkeys trust trustdefaultkeys trust uris pgp keystore files installed osgi bundles list url urls arraylist array list url osgiutils utils findentriesbypattern find entries pattern context springframework roo felix pgp asc collections sort urls comparator url compare url url url url url url url url toexternalform external form compareto compare url url toexternalform external form trust url url urls inputstream input stream inputstream input stream inputstream input stream url openstream open stream trust getpublickey key inputstream input stream ioexception exception ioutils utils closequietly close quietly inputstream input stream getkeystorephysicallocation key store physical location roo pgp file getcanonicalpath canonical path ioexception exception illegalstateexception illegal exception isautomatictrust automatic trust automatictrust automatic trust setautomatictrust set automatic trust automatictrust automatic trust automatictrust automatic trust automatictrust automatic trust suppresswarnings suppress warnings unchecked list pgppublickeyring pgp key ring gettrustedkeys trusted roo pgp file exists arraylist array list pgppublickeyring pgp key ring fileinputstream file input stream fis fis fileinputstream file input stream roo pgp file pgppublickeyringcollection pgp key ring collection pubrings pub rings pgppublickeyringcollection pgp key ring collection pgputil pgp util getdecoderstream decoder stream fis iterator pgppublickeyring pgp key ring rit pubrings pub rings getkeyrings key rings list pgppublickeyring pgp key ring result arraylist array list pgppublickeyring pgp key ring rit hasnext pgppublickeyring pgp key ring pgppub pgp pub rit rememberkey remember key pgppub pgp pub result add pgppub pgp pub result exception illegalargumentexception illegal argument exception ioutils utils closequietly close quietly fis pgppublickeyring pgp key ring trust pgpkeyid pgp key keyid key notnull keyid key key required pgppublickeyring pgp key ring keyring key ring getpublickey key keyid key trust keyring key ring pgppublickeyring pgp key ring trust pgppublickeyring pgp key ring keyring key ring rememberkey remember key keyring key ring trust list pgppublickeyring pgp key ring trusted gettrustedkeys trusted store key revoked keyring key ring getpublickey key isrevoked revoked key pgpkeyid pgp key keyring key ring getpublickey key revoked trusted trust write disk trusted add keyring key ring outputstream output stream fos pgppublickeyringcollection pgp key ring collection newcollection collection pgppublickeyringcollection pgp key ring collection trusted fos fileoutputstream file output stream roo pgp file newcollection collection encode fos exception illegalstateexception illegal exception ioutils utils closequietly close quietly fos keyring key ring suppresswarnings suppress warnings unchecked pgppublickeyring pgp key ring untrust pgpkeyid pgp key keyid key notnull keyid key key required trust list pgppublickeyring pgp key ring trusted gettrustedkeys trusted build list trust ends list pgppublickeyring pgp key ring stilltrusted trusted arraylist array list pgppublickeyring pgp key ring locate element remove record pgppublickeyring pgp key ring removed pgppublickeyring pgp key ring candidate trusted stilltrust trust iterator pgppublickey pgp key candidate getpublickeys hasnext pgppublickey pgp key pgpkey pgp key pgpkeyid pgp key candidatekeyid candidate key pgpkeyid pgp key pgpkey pgp key removed candidatekeyid candidate key equals keyid key stilltrust trust removed candidate stilltrust trust stilltrusted trusted add candidate notnull removed key keyid key trusted write disk outputstream output stream fos pgppublickeyringcollection pgp key ring collection newcollection collection pgppublickeyringcollection pgp key ring collection stilltrusted trusted fos fileoutputstream file output stream roo pgp file newcollection collection encode fos exception illegalstateexception illegal exception ioutils utils closequietly close quietly fos removed sortedmap sorted map pgpkeyid pgp key refresh sortedmap sorted map pgpkeyid pgp key result treemap tree map pgpkeyid pgp key trust list pgppublickeyring pgp key ring trusted gettrustedkeys trusted build list refreshed list pgppublickeyring pgp key ring stilltrusted trusted arraylist array list pgppublickeyring pgp key ring locate element remove record pgppublickeyring pgp key ring candidate trusted pgppublickey pgp key firstkey key candidate getpublickey key pgpkeyid pgp key candidatekeyid candidate key pgpkeyid pgp key firstkey key refresh pgppublickeyring pgp key ring newkeyring key ring newkeyring key ring getpublickey key candidatekeyid candidate key exception can retrieve stilltrusted trusted add candidate result candidatekeyid candidate key warning retained original download issue store key revoked newkeyring key ring getpublickey key isrevoked revoked result candidatekeyid candidate key warning key revoked removed trust list stilltrusted trusted add newkeyring key ring result candidatekeyid candidate key success write disk outputstream output stream fos pgppublickeyringcollection pgp key ring collection newcollection collection pgppublickeyringcollection pgp key ring collection stilltrusted trusted fos fileoutputstream file output stream roo pgp file newcollection collection encode fos exception illegalstateexception illegal exception ioutils utils closequietly close quietly fos result pgppublickeyring pgp key ring getpublickey key pgpkeyid pgp key keyid key notnull keyid key key required inputstream input stream url lookup getkeyserverurltoretrievekeyid key server url retrieve key keyid key urlinputstreamservice url input stream service openconnection open connection lookup getpublickey key exception illegalstateexception illegal exception key keyid key key server ioutils utils closequietly close quietly pgppublickeyring pgp key ring getpublickey key inputstream input stream object obj pgpobjectfactory pgp object factory pgpfact pgp fact pgpobjectfactory pgp object factory pgputil pgp util getdecoderstream decoder stream obj pgpfact pgp fact nextobject object exception illegalstateexception illegal exception obj pgppublickeyring pgp key ring pgppublickeyring pgp key ring keyring key ring pgppublickeyring pgp key ring obj rememberkey remember key keyring key ring keyring key ring illegalstateexception illegal exception pblic key obtains url download key key server key uploaded keyid key hex encoded key download required url url getkeyserverurltoretrievekeyid key server url retrieve key pgpkeyid pgp key keyid key url defaultkeyserverurl key server url keyid key malformedurlexception malformed url exception illegalstateexception illegal exception url getkeyserverurltoretrievekeyinformation key server url retrieve key pgpkeyid pgp key keyid key notnull keyid key key required url keyurl key url getkeyserverurltoretrievekeyid key server url retrieve key keyid key url keyindexurl key url url keyurl key url getprotocol protocol keyurl key url getauthority authority keyurl key url getpath path fingerprint search url keyindexurl key url tostring keyid key malformedurlexception malformed url exception illegalstateexception illegal exception signaturedecision signature decision issignatureacceptable signature acceptable inputstream input stream signature ioexception exception notnull signature signature input stream required pgpobjectfactory pgp object factory factory pgpobjectfactory pgp object factory pgputil pgp util getdecoderstream decoder stream signature object obj factory nextobject object notnull obj unable retrieve signature stream pgpsignaturelist pgp signature list obj pgpcompresseddata pgp compressed data factory pgpobjectfactory pgp object factory pgpcompresseddata pgp compressed data obj getdatastream data stream exception illegalstateexception illegal exception pgpsignaturelist pgp signature list factory nextobject object pgpsignaturelist pgp signature list obj pgpsignature pgp signature pgpsignature pgp signature notnull pgpsignature pgp signature unable retrieve signature stream pgpkeyid pgp key keyidinhex key hex pgpkeyid pgp key pgpsignature pgp signature special store key valid discoveredkeyids discovered key ids add keyidinhex key hex signatureacceptable signature acceptable loop user trusts key pgppublickeyring pgp key ring keyring key ring gettrustedkeys trusted pgpkeyid pgp key candidate pgpkeyid pgp key keyring key ring getpublickey key candidate equals keyidinhex key hex signatureacceptable signature acceptable signatureacceptable signature acceptable automatictrust automatic trust don approve signature user told trust keyidinhex key hex signatureacceptable signature acceptable signaturedecision signature decision pgpsignature pgp signature keyidinhex key hex signatureacceptable signature acceptable isresourcesignedbysignature resource signed signature inputstream input stream resource inputstream input stream signature pgppublickey pgp key publickey key pgpsignature pgp signature pgpsignature pgp signature signature armoredinputstream armored input stream signature armoredinputstream armored input stream signature pgpsignature pgp signature issignatureacceptable signature acceptable signature getpgpsignature pgp signature pgppublickeyring pgp key ring keyring key ring getpublickey key pgpkeyid pgp key pgpsignature pgp signature rememberkey remember key keyring key ring publickey key keyring key ring getpublickey key notnull publickey key key signer key pgpsignature pgp signature pgpsignature pgp signature initverify init verify publickey key verify signed content buff buffer size chunk chunk resource read buff chunk pgpsignature pgp signature update buff chunk chunk pgpsignature pgp signature verify exception illegalstateexception illegal exception sortedset sorted set pgpkeyid pgp key getdiscoveredkeyids discovered key ids collections unmodifiablesortedset unmodifiable sorted set discoveredkeyids discovered key ids simply stores key link discoveredkeyids discovered key ids reference key ids link pgppublickeyring pgp key ring ensure input valid key locating key ids signed key note link discoveredkeyids discovered key ids key functions simply user convenience keyring key ring key store required suppresswarnings suppress warnings unchecked rememberkey remember key pgppublickeyring pgp key ring keyring key ring pgppublickey pgp key key keyring key ring getpublickey key key pgpkeyid pgp key keyid key pgpkeyid pgp key key discoveredkeyids discovered key ids add keyid key iterator useriditerator user iterator key getuserids user useriditerator user iterator hasnext userid user useriditerator user iterator iterator pgpsignature pgp signature signatureiterator signature iterator key getsignaturesforid signatures userid user signatureiterator signature iterator hasnext pgpsignature pgp signature signature signatureiterator signature iterator pgpkeyid pgp key signaturekeyid signature key pgpkeyid pgp key signature discoveredkeyids discovered key ids add signaturekeyid signature key